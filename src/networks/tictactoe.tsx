import * as Synaptic from 'synaptic';

// 0 = neural network cpu player / O
// 0.5 = empty
// 1 = human opponent/ X
export const trainingSet = [{'input':[0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0],'output':[1]},{'input':[0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0],'output':[0]},{'input':[0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0],'output':[1]},{'input':[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0],'output':[0]},{'input':[0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0],'output':[1]},{'input':[0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,1,0],'output':[1]},{'input':[0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,1,0],'output':[0]},{'input':[0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],'output':[1]},{'input':[0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,1,0],'output':[0]},{'input':[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0],'output':[0]},{'input':[0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0],'output':[0]},{'input':[0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0],'output':[0]},{'input':[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],'output':[1]},{'input':[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],'output':[1]},{'input':[0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,1,0],'output':[0]},{'input':[0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,0,1,0],'output':[0]},{'input':[0,1,1,0,1,0,0,1,0,1,1,0,0,1,0,0,0,0],'output':[1]},{'input':[1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],'output':[0]},{'input':[0.5,0.5,0.5,1,0.5,0,0.5,0.5,0.5],'output':[0]},{'input':[0,0.5,0.5,1,0.5,0.5,0.5,0.5,0.5],'output':[0]},{'input':[0.5,0.5,0.5,1,0.5,0,0.5,0.5,0.5],'output':[0]},{'input':[0,0.5,0.5,1,0.5,0.5,0.5,0.5,0.5],'output':[0]},{'input':[0.5,0.5,0.5,1,0.5,0,0.5,0.5,0.5],'output':[0]},{'input':[0,0.5,0.5,1,0.5,0.5,0.5,0.5,0.5],'output':[0]},{'input':[0.5,0.5,0.5,1,0.5,0,1,0,0.5],'output':[0]},{'input':[0,0.5,0,1,1,0,1,0.5,0.5],'output':[1]},{'input':[0,0.5,0.5,0.5,1,0,1,0.5,0.5],'output':[0]},{'input':[0.5,0.5,0,0.5,1,0,1,0,1],'output':[0]},{'input':[0.5,0.5,0.5,0.5,0.5,0,0.5,1,0.5],'output':[0]},{'input':[0.5,0.5,0.5,0.5,0,0,0.5,1,1],'output':[0]},{'input':[0,0.5,0.5,0.5,0,0.5,0.5,1,1],'output':[0]},{'input':[0.5,0.5,0.5,0.5,0,0,0.5,1,1],'output':[0]},{'input':[0,0.5,0.5,0.5,0,0.5,0.5,1,1],'output':[0]},{'input':[0.5,0.5,0.5,0.5,0,0,0.5,1,1],'output':[0]},{'input':[0,0.5,0.5,0.5,0,0.5,0.5,1,1],'output':[0]},{'input':[0.5,0.5,0.5,0.5,0,0,0.5,1,1],'output':[0]},{'input':[0,0.5,0.5,0.5,0,0.5,0.5,1,1],'output':[0]},{'input':[0,0.5,0.5,0.5,1,0,1,0.5,0.5],'output':[0]},{'input':[0,1,0,0.5,1,0,1,0.5,0.5],'output':[0]},{'input':[0,1,0,0.5,1,0.5,1,0.5,0],'output':[0]},{'input':[0,1,0,0.5,1,0,1,0.5,0.5],'output':[0]},{'input':[0,1,0,0.5,1,0.5,1,0.5,0],'output':[0]},{'input':[0,1,0,0.5,1,0,1,0.5,0.5],'output':[0]},{'input':[0,1,0,0.5,1,0.5,1,0.5,0],'output':[0]},{'input':[0,1,0,0.5,1,0,1,0.5,0.5],'output':[0]},{'input':[0,1,0,0.5,1,0.5,1,0.5,0],'output':[0]},{'input':[0,1,0,0.5,1,0,1,0.5,0.5],'output':[0]},{'input':[0,1,0,0.5,1,0.5,1,0.5,0],'output':[0]},{'input':[0,1,0,0.5,1,0,1,0.5,0.5],'output':[0]},{'input':[0,1,0,0.5,1,0.5,1,0.5,0],'output':[0]},{'input':[0,1,0,0.5,1,0,1,0.5,0.5],'output':[0]},{'input':[0,1,0,0.5,1,0.5,1,0.5,0],'output':[0]},{'input':[0,1,0,0.5,1,0,1,0.5,0.5],'output':[0]},{'input':[0,1,0,0.5,1,0.5,1,0.5,0],'output':[0]},{'input':[0,1,0,0.5,1,0,1,0.5,0.5],'output':[0]},{'input':[0,1,0,0.5,1,0.5,1,0.5,0],'output':[0]},{'input':[0,1,0,0.5,1,0,1,0.5,0.5],'output':[0]},{'input':[0,1,0,0.5,1,0.5,1,0.5,0],'output':[0]},{'input':[0,1,0,0.5,1,0,1,0.5,0.5],'output':[0]},{'input':[0,1,0,0.5,1,0.5,1,0.5,0],'output':[0]},{'input':[0,1,0,0.5,1,0,1,0.5,0.5],'output':[0]},{'input':[0,0.5,0.5,1,0.5,0.5,0.5,0.5,0.5],'output':[0]},{'input':[0.5,0.5,0.5,1,0.5,0,0.5,0.5,0.5],'output':[0]},{'input':[0,0.5,0.5,1,0.5,0.5,0.5,0.5,0.5],'output':[0]},{'input':[0.5,0.5,0.5,1,0.5,0,0.5,0.5,0.5],'output':[0]},{'input':[0,0.5,0.5,1,0.5,0.5,0.5,0.5,0.5],'output':[0]},{'input':[0.5,0.5,0.5,1,0.5,0,0.5,0.5,0.5],'output':[0]},{'input':[0,0.5,0.5,1,0.5,0.5,0.5,0.5,0.5],'output':[0]},{'input':[0.5,0.5,0.5,1,0.5,0,0.5,0.5,0.5],'output':[0]},{'input':[0,0.5,0.5,1,0.5,0.5,0.5,0.5,0.5],'output':[0]},{'input':[0.5,0.5,0.5,1,0.5,0,0.5,0.5,0.5],'output':[0]},{'input':[0,0.5,0.5,1,0.5,0.5,0.5,0.5,0.5],'output':[0]},{'input':[0.5,0.5,0.5,1,0.5,0,0.5,0.5,0.5],'output':[0]},{'input':[0,0.5,0.5,1,0.5,0.5,0.5,0.5,0.5],'output':[0]},{'input':[0.5,0.5,0.5,1,0.5,0,0.5,0.5,0.5],'output':[0]},{'input':[0,0.5,0.5,1,0.5,0.5,0.5,0.5,0.5],'output':[0]},{'input':[0.5,0.5,1,0.5,0.5,0.5,0,0.5,0.5],'output':[0]},{'input':[0.5,0.5,1,0.5,0,0.5,0,0.5,1],'output':[0]},{'input':[0.5,1,1,1,0,0,0,0,1],'output':[0]},{'input':[0.5,0.5,1,1,0,0.5,0,0.5,0.5],'output':[0]},{'input':[0.5,0.5,1,1,0,0,0.5,0.5,0.5],'output':[0]},{'input':[0.5,0.5,1,1,0,0.5,0,0.5,0.5],'output':[0]},{'input':[0.5,0.5,1,1,0,0,0.5,0.5,0.5],'output':[0]}]

const inputLayer = new Synaptic.Layer(18);
const hiddenLayer = new Synaptic.Layer(9);
const outputLayer = new Synaptic.Layer(1);

inputLayer.project(hiddenLayer);
hiddenLayer.project(outputLayer);

export const learningRate = 0.3;
export const myNetwork = new Synaptic.Network({
  hidden: [hiddenLayer],
  input: inputLayer,
  output: outputLayer
});

export function massageInput(input: number[]) {
  if (input.length === 18) {
    return input;
  }

  const newInput = [];
  for (const value of input) {
    newInput.push(value === 1 ? 1 : 0); // X node
    newInput.push(value === 0 ? 1 : 0); // O node
  }
  
  return newInput;
}

for (const set of trainingSet) {
  set.input = massageInput(set.input);
}

const trainer = new Synaptic.Trainer(myNetwork);
trainer.train(trainingSet, {
  cost: Synaptic.Trainer.cost.MSE,
  error: .005,
  iterations: 20000,
  log: 1000,
  rate: learningRate,
  shuffle: true
});
